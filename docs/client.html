<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 6.3.2" />
    <title>client API documentation</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%2244.5%202.5%2015%2015%22%3E%3Cpath%20d%3D%22M49.351%2021.041c-.233-.721-.546-2.408-.772-4.076-.042-.09-.067-.187-.046-.288-.166-1.347-.277-2.625-.241-3.351-1.378-1.008-2.271-2.586-2.271-4.362%200-.976.272-1.935.788-2.774.057-.094.122-.18.184-.268-.033-.167-.052-.339-.052-.516%200-1.477%201.202-2.679%202.679-2.679.791%200%201.496.352%201.987.9a6.3%206.3%200%200%201%201.001.029c.492-.564%201.207-.929%202.012-.929%201.477%200%202.679%201.202%202.679%202.679a2.65%202.65%200%200%201-.269%201.148c.383.747.595%201.572.595%202.41%200%202.311-1.507%204.29-3.635%205.107.037.699.147%202.27.423%203.294l.137.461c.156%202.136-4.612%205.166-5.199%203.215zm.127-4.919a4.78%204.78%200%200%200%20.775-.584c-.172-.115-.505-.254-.88-.378zm.331%202.302l.828-.502c-.202-.143-.576-.328-.984-.49zm.45%202.157l.701-.403c-.214-.115-.536-.249-.891-.376l.19.779zM49.13%204.141c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm.735-.389a1.15%201.15%200%200%201%20.314.783%201.16%201.16%200%200%201-1.162%201.162c-.457%200-.842-.27-1.032-.653-.026.117-.042.238-.042.362a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.843-.626-1.535-1.436-1.654zm3.076%201.654a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.037-.009-.072-.011-.109-.21.3-.541.508-.935.508a1.16%201.16%200%200%201-1.162-1.162%201.14%201.14%200%200%201%20.474-.912c-.015%200-.03-.005-.045-.005-.926.001-1.679.754-1.679%201.68zm1.861-1.265c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm1.823%204.823c0-.52-.103-1.035-.288-1.52-.466.394-1.06.64-1.717.64-1.144%200-2.116-.725-2.499-1.738-.383%201.012-1.355%201.738-2.499%201.738-.867%200-1.631-.421-2.121-1.062-.307.605-.478%201.267-.478%201.942%200%202.486%202.153%204.51%204.801%204.51s4.801-2.023%204.801-4.51zm-3.032%209.156l-.146-.492c-.276-1.02-.395-2.457-.444-3.268a6.11%206.11%200%200%201-1.18.115%206.01%206.01%200%200%201-2.536-.562l.006.175c.802.215%201.848.612%202.021%201.25.079.295-.021.601-.274.837l-.598.501c.667.304%201.243.698%201.311%201.179.02.144.022.507-.393.787l-.564.365c1.285.521%201.361.96%201.381%201.126.018.142.011.496-.427.746l-.854.489c.064-1.19%201.985-2.585%202.697-3.248zM49.34%209.925c0-.667%201-.667%201%200%200%20.653.818%201.205%201.787%201.205s1.787-.552%201.787-1.205c0-.667%201-.667%201%200%200%201.216-1.25%202.205-2.787%202.205s-2.787-.989-2.787-2.205zm-.887-7.633c-.093.077-.205.114-.317.114a.5.5%200%200%201-.318-.886L49.183.397a.5.5%200%200%201%20.703.068.5.5%200%200%201-.069.703zm7.661-.065c-.086%200-.173-.022-.253-.068l-1.523-.893c-.575-.337-.069-1.2.506-.863l1.523.892a.5.5%200%200%201%20.179.685c-.094.158-.261.247-.432.247z%22%20fill%3D%22%233bb300%22/%3E%3C/svg%3E"/>


<style type="text/css">/*! * Bootstrap Reboot v5.0.0-beta1 (https://getbootstrap.com/) * Copyright 2011-2020 The Bootstrap Authors * Copyright 2011-2020 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}[tabindex="-1"]:focus:not(:focus-visible){outline:0!important}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus{outline:dotted 1px;outline:-webkit-focus-ring-color auto 5px}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style type="text/css">/*! pygments syntax highlighting */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.pdoc .hll{background-color:#ffffcc}.pdoc{background:#f8f8f8;}.pdoc .c{color:#408080; font-style:italic}.pdoc .err{border:1px solid #FF0000}.pdoc .k{color:#008000; font-weight:bold}.pdoc .o{color:#666666}.pdoc .ch{color:#408080; font-style:italic}.pdoc .cm{color:#408080; font-style:italic}.pdoc .cp{color:#BC7A00}.pdoc .cpf{color:#408080; font-style:italic}.pdoc .c1{color:#408080; font-style:italic}.pdoc .cs{color:#408080; font-style:italic}.pdoc .gd{color:#A00000}.pdoc .ge{font-style:italic}.pdoc .gr{color:#FF0000}.pdoc .gh{color:#000080; font-weight:bold}.pdoc .gi{color:#00A000}.pdoc .go{color:#888888}.pdoc .gp{color:#000080; font-weight:bold}.pdoc .gs{font-weight:bold}.pdoc .gu{color:#800080; font-weight:bold}.pdoc .gt{color:#0044DD}.pdoc .kc{color:#008000; font-weight:bold}.pdoc .kd{color:#008000; font-weight:bold}.pdoc .kn{color:#008000; font-weight:bold}.pdoc .kp{color:#008000}.pdoc .kr{color:#008000; font-weight:bold}.pdoc .kt{color:#B00040}.pdoc .m{color:#666666}.pdoc .s{color:#BA2121}.pdoc .na{color:#7D9029}.pdoc .nb{color:#008000}.pdoc .nc{color:#0000FF; font-weight:bold}.pdoc .no{color:#880000}.pdoc .nd{color:#AA22FF}.pdoc .ni{color:#999999; font-weight:bold}.pdoc .ne{color:#D2413A; font-weight:bold}.pdoc .nf{color:#0000FF}.pdoc .nl{color:#A0A000}.pdoc .nn{color:#0000FF; font-weight:bold}.pdoc .nt{color:#008000; font-weight:bold}.pdoc .nv{color:#19177C}.pdoc .ow{color:#AA22FF; font-weight:bold}.pdoc .w{color:#bbbbbb}.pdoc .mb{color:#666666}.pdoc .mf{color:#666666}.pdoc .mh{color:#666666}.pdoc .mi{color:#666666}.pdoc .mo{color:#666666}.pdoc .sa{color:#BA2121}.pdoc .sb{color:#BA2121}.pdoc .sc{color:#BA2121}.pdoc .dl{color:#BA2121}.pdoc .sd{color:#BA2121; font-style:italic}.pdoc .s2{color:#BA2121}.pdoc .se{color:#BB6622; font-weight:bold}.pdoc .sh{color:#BA2121}.pdoc .si{color:#BB6688; font-weight:bold}.pdoc .sx{color:#008000}.pdoc .sr{color:#BB6688}.pdoc .s1{color:#BA2121}.pdoc .ss{color:#19177C}.pdoc .bp{color:#008000}.pdoc .fm{color:#0000FF}.pdoc .vc{color:#19177C}.pdoc .vg{color:#19177C}.pdoc .vi{color:#19177C}.pdoc .vm{color:#19177C}.pdoc .il{color:#666666}</style>
<style type="text/css">/*! pdoc */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f7f7f7;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}body{background-color:var(--pdoc-background);}html, body{width:100%;height:100%;}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main{padding:2rem 3vw;}.git-button{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}#navtoggle{display:none;}}#togglestate{display:none;}nav.pdoc{--pad:1.75rem;--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav.pdoc > div > ul > li{padding-left:0;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3, .pdoc h4{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{--shift:-40px;text-align:right;margin-top:var(--shift);margin-bottom:calc(0px - var(--shift));clear:both;filter:opacity(1);}.pdoc details:not([open]){height:0;overflow:visible;}.pdoc details > summary{font-size:.75rem;cursor:pointer;color:var(--muted);border-width:0;padding:0 .7em;display:inline-block;display:inline list-item;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc details > div{margin-top:calc(0px - var(--shift) / 2);text-align:left;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:3rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{color:var(--text);margin:1rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}</style>
</head>
<body>        <nav class="pdoc">
            <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
            <input id="togglestate" type="checkbox">
            <div>
                        <a class="pdoc-button module-list-button" href="./">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                            &nbsp;
                            Module Index
                        </a>




                    <h2>API Documentation</h2>
                        <ul class="memberlist">
            <li>
                    <a class="class" href="#client">client</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#client.__init__">client</a>
                        </li>
                        <li>
                                <a class="function" href="#client.initializeConnection">initializeConnection</a>
                        </li>
                        <li>
                                <a class="function" href="#client.handleIncoming">handleIncoming</a>
                        </li>
                        <li>
                                <a class="function" href="#client.receiveMessage">receiveMessage</a>
                        </li>
                        <li>
                                <a class="function" href="#client.getAllRooms">getAllRooms</a>
                        </li>
                        <li>
                                <a class="function" href="#client.getAllUsers">getAllUsers</a>
                        </li>
                        <li>
                                <a class="function" href="#client.listPublicRooms">listPublicRooms</a>
                        </li>
                        <li>
                                <a class="function" href="#client.joinRoom">joinRoom</a>
                        </li>
                        <li>
                                <a class="function" href="#client.changeRoom">changeRoom</a>
                        </li>
                        <li>
                                <a class="function" href="#client.enterPrivateChat">enterPrivateChat</a>
                        </li>
                        <li>
                                <a class="function" href="#client.sendBroadcastMessage">sendBroadcastMessage</a>
                        </li>
                        <li>
                                <a class="function" href="#client.sendServerQuit">sendServerQuit</a>
                        </li>
                        <li>
                                <a class="function" href="#client.listUsers">listUsers</a>
                        </li>
                        <li>
                                <a class="function" href="#client.getUsersInCurrentRoom">getUsersInCurrentRoom</a>
                        </li>
                        <li>
                                <a class="function" href="#client.listCommands">listCommands</a>
                        </li>
                        <li>
                                <a class="function" href="#client.handleInput">handleInput</a>
                        </li>
                        <li>
                                <a class="function" href="#client.listMyRooms">listMyRooms</a>
                        </li>
                        <li>
                                <a class="function" href="#client.sendMessage">sendMessage</a>
                        </li>
                        <li>
                                <a class="function" href="#client.showKnownUsers">showKnownUsers</a>
                        </li>
                        <li>
                                <a class="function" href="#client.sendPrivateMessage">sendPrivateMessage</a>
                        </li>
                        <li>
                                <a class="function" href="#client.showCurrentRoomMessages">showCurrentRoomMessages</a>
                        </li>
                        <li>
                                <a class="function" href="#client.leaveRoom">leaveRoom</a>
                        </li>
                        <li>
                                <a class="function" href="#client.makeRoom">makeRoom</a>
                        </li>
                </ul>

            </li>
    </ul>


                    <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
                        built with <span class="visually-hidden">pdoc</span><img
                            alt="pdoc logo"
                            src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
                    </a>
            </div>
        </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
client    </h1>

                
                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># low level socket library to allow ease of use when working with TCP connections.</span>
<span class="kn">import</span> <span class="nn">socket</span>

<span class="c1"># contains Opcodes and packet objects for use in the program.</span>
<span class="kn">from</span> <span class="nn">irc_protocol</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># This library allows us to turn objects into a byte stream.</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="c1"># import capability to have multiple threads, allows us to handle sending and receiving at the same time.</span>
<span class="kn">from</span> <span class="nn">_thread</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">class</span> <span class="nc">client</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents a client to our IRC service. This class provides all abstractions and</span>
<span class="sd">    state that are needed for a client to interact with the IRC service.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Our constructor for client. It takes a name as a string for its sole argument.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c1"># key - senderName/roomName    value - list messages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># Our constructor for client. It takes a name as a string for its sole argument.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">knownUsers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentRoomUsers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serverPort</span> <span class="o">=</span> <span class="mi">6667</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serverIP</span> <span class="o">=</span> <span class="s2">&quot;192.168.1.6&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span> <span class="o">=</span> <span class="mi">4096</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">initializeConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method attempts to connect with the IRC server. If a connection is made, then the user&#39;s name</span>
<span class="sd">        is sent to the server for verification. If the name is legal, then the user is allowed to connect and </span>
<span class="sd">        use the IRC functionality. If the name is illegal, then the program ends with a message to the user.</span>
<span class="sd">        The user can then attempt to enter a new name and try to connect again. &quot;&quot;&quot;</span>

        <span class="c1"># This sets the option for a keepalive pulse to the server.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_KEEPALIVE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># attempt to establish an initial connection. Throws an error if no connection</span>
        <span class="c1"># can be made</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">serverIP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">serverPort</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

        <span class="c1"># catches server acknowledgement. If there is no ack, then the program ends.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">serverResponse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, we couldn&#39;t establish an initial connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="c1"># Client sends their chosen name to the server for verification.</span>
        <span class="c1"># The opcode indicates that the user is wanting to join the server.</span>
        <span class="n">byteStream</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ircPacket</span><span class="p">(</span><span class="n">ircHeader</span><span class="p">(</span>
            <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">REGISTER_CLIENT_REQ</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

        <span class="c1"># attempt to send the message. Throws an error and ends the program if the message cannot be sent.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">byteStream</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Your initial header didn&#39;t go through.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="c1"># attempt to receive the server&#39;s response message for name verification.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">serverResponse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="n">formattedServerResponse</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">serverResponse</span><span class="p">)</span>

        <span class="c1"># If the name is valid then do initial setup like join the client to the &quot;Lobby&quot; room.</span>
        <span class="c1"># Then start a new thread that handles ONLY receiving server messages. The &quot;main&quot; thread</span>
        <span class="c1"># handles user input and sending messages to the server.</span>
        <span class="k">if</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">REGISTER_CLIENT_RESP</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully joined server</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;Lobby&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="s2">&quot;Lobby&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">start_new_thread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handleIncoming</span><span class="p">,</span> <span class="p">())</span>
            <span class="k">while</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handleInput</span><span class="p">()</span>
            <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_NAME</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry, but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> cannot be used because it is invalid. Please enter a new name.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_NAME_LENGTH</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is too long, please try again with a new name.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_NAME_EXISTS</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry, but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> already exists. Please enter a new name.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;An error has occurred. Our server may be down. Please try again later.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;server down&quot;</span>

    <span class="c1"># def sendPacketToServer(self, packet):</span>

    <span class="k">def</span> <span class="nf">handleIncoming</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method is only used by the secondary, &quot;listening&quot; thread for a client. It receives a byte stream from the server, reconstitutes it into a packet object using the</span>
<span class="sd">        pickle library. Then calls self.receiveMessage to handle how the client interprets the server&#39;s message.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">serverResponse</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">receiveMessage</span><span class="p">(</span><span class="n">serverResponse</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error encountered: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ending program&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">receiveMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serverResponse</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method is only used by the secondary, &quot;listening&quot; thread for the client</span>
<span class="sd">        It takes a packet as its sole argument. This method then checks the packet&#39;s opcode to determine</span>
<span class="sd">        how to handle the packet.&quot;&quot;&quot;</span>

        <span class="c1"># FORWARD_MESSAGE</span>
        <span class="c1"># A message was received from another client who is also subscribed to a room</span>
        <span class="c1"># that this client is also subscribed to. This will update the stored messages for this room.</span>
        <span class="k">if</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">FORWARD_MESSAGE</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">receiverName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># SEND_BROADCAST_RESP</span>
        <span class="c1"># This method updates the sending client&#39;s message dictionary for a broadcast message</span>
        <span class="c1"># for each successful message sent, adding those messages to their corresponding room.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_BROADCAST_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">receiverName</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">room</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;Me: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># START_PRIV_CHAT_RESP</span>
        <span class="c1"># The sending client has recieved a response that they are able to initiate</span>
        <span class="c1"># a private chat with the requested client. This adds a new private chat room for</span>
        <span class="c1"># the sending client.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">START_PRIV_CHAT_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You are now chatting with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># SEND_PRIV_MSG_RESP</span>
        <span class="c1"># The sending client was successfully able to send a private message to another client.</span>
        <span class="c1"># This updates the sender&#39;s private message chat thread with the sent message.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_PRIV_MSG_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="n">privRoomName</span> <span class="o">=</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">privRoomName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;Me: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># LIST_MEMBERS_OF_ROOM_RESP</span>
        <span class="c1"># The sending client was successfully able to request a list of active clients</span>
        <span class="c1"># who are currently in the same room as the requesting client. The list gets</span>
        <span class="c1"># replaced with an updated one with every call to this method.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_MEMBERS_OF_ROOM_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoomUsers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># MAKE_ROOM_RESP</span>
        <span class="c1"># room made successfully and the user is added to that room</span>
        <span class="c1"># a new entry in the message dictionary is added for the new room.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">MAKE_ROOM_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># A client has received a private message. If the private chat thread already exists then the message</span>
        <span class="c1"># is appended to the corresponding entry in the message dictionary. If the chat thread does not exist then</span>
        <span class="c1"># a new entry is created in the message dictionary.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">FORWARD_PRIVATE_MESSAGE</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># A client attempted to create a room that already exists.</span>
        <span class="c1"># The room is not recreated, and the client is told that they can join it.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ROOM_ALREADY_EXISTS</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> already exists, you may choose to join it.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># SEND_MSG_RESP</span>
        <span class="c1"># A client was able to successfully send a message to a room.</span>
        <span class="c1"># The message they sent is automatically appended to that rooms message dictionary entry.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_MSG_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;Me: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># JOIN_ROOM_RESP</span>
        <span class="c1"># Client was able to successfully join their desired room.</span>
        <span class="c1"># a new entry in the message dictionary is made for that room and</span>
        <span class="c1"># the user is told of the success</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">JOIN_ROOM_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server sent back </span><span class="si">{</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">room</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">room</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You have successfully joined </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># too many users in room</span>
        <span class="c1"># client is told that they cannot enter a room since it is full</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_TOO_MANY_USERS</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;You cannot currently join </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> because it is currently full.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please try again later.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># room doesn&#39;t exist</span>
        <span class="c1"># client requested to join a room that doesn&#39;t exist. Error message</span>
        <span class="c1"># is given to client</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ROOM_DOES_NOT_EXIST</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sorry, but the room: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> doesn&#39;t exist. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please make a new room or try to join a different one.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1">#already in room</span>
        <span class="c1"># user tried to join a chat room they are already in.</span>
        <span class="c1"># User is prompted to change into it.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_USER_ALREADY_IN_ROOM</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silly goose! You are already in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Try the &#39;-changeroom&#39; or &#39;-cr&#39; command.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># LIST_USERS_RESP</span>
        <span class="c1"># Client requested all known users which are connected to the server</span>
        <span class="c1"># the list of all known clients is added to requesting client&#39;s state</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_USERS_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knownUsers</span> <span class="o">=</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># LIST_ROOMS_RESP</span>
        <span class="c1"># client requested a list of all chat rooms on the server.</span>
        <span class="c1"># server returns the list of all chat rooms and client updates its state</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_ROOMS_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span> <span class="o">=</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># Client attempted to make a room that has an illegal character in it, or it</span>
        <span class="c1"># begins/ends with a space character.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_NAME</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> is not a valid name. Please try making a new room with a different name.&quot;</span><span class="p">)</span>

        <span class="c1"># Client attempted to make a room using a name that is longer than 32 chars or has a length of 0.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_ROOM_NAME_LENGTH</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> is too long of a name. Please try making a room with a shorter name.&quot;</span><span class="p">)</span>

        <span class="c1"># Client attempted to send a message longer than 140 characters.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_MESSAGE_LENGTH</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Sorry but the message you tried to send is too long. Keep it 140 characters or less.&quot;</span><span class="p">)</span>

        <span class="c1"># generic unexpected error. Not recoverable.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCOde</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">IRC_ERR</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Sorry, an unexpected error has occurred and the program is now exiting.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

            <span class="c1"># Nothing should be able to reach this statement. This is probably</span>
            <span class="c1"># a catastropic error, so exit program.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Sorry, an unexpected error has occurred and the program is now exiting.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getAllRooms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method sends a request to the server asking it for a list of all public rooms that the server is</span>
<span class="sd">        keeping track of.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_ROOMS_REQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getAllUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method sends a request to the server asking it for a list of all connected clients.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_USERS_REQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection. In getAllUsers()&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">listPublicRooms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all public chat rooms. Doesn&#39;t show private chat &quot;rooms&quot;.&quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">joinRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; This method first displays all public chat rooms on the server.</span>
<span class="sd">         The user can then enter a list of numbers corresponding to certain rooms.</span>
<span class="sd">         Then a request is sent to the server asking it to add the user to those rooms.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">listPublicRooms</span><span class="p">()</span>
        <span class="n">strDesiredRooms</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Which room numbers do you wish to join?: &quot;</span><span class="p">)</span>
        <span class="n">indexDesiredRooms</span> <span class="o">=</span> <span class="n">strDesiredRooms</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span>
        <span class="n">desiredRooms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">numRooms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span>
            <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numRooms</span><span class="p">):</span>
                <span class="n">strindex</span> <span class="o">=</span> <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">strindex</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indexDesiredRooms</span><span class="p">:</span>
        
                <span class="n">desiredRooms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
                
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;desired rooms: </span><span class="si">{</span><span class="n">desiredRooms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">joinRoomPayload</span> <span class="o">=</span> <span class="n">roomPayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">desiredRooms</span><span class="p">)</span>
        <span class="n">payloadLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">desiredRooms</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">joinRoomHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span>
            <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">JOIN_ROOM_REQ</span><span class="p">,</span> <span class="n">payloadLength</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">joinRoomHeader</span><span class="p">,</span> <span class="n">joinRoomPayload</span><span class="p">)))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection. In joinARoom()&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">changeRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method lets a user change state into a room that they are currently joined to.</span>
<span class="sd">        It will then print the messages for that room.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;What room would you like to enter?: &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showCurrentRoomMessages</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry that room either doesn&#39;t exist or you have not joined it yet.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">enterPrivateChat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desiredUser</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows the user to change state into a private chat with another client&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">desiredUser</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="n">desiredUser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">sendBroadcastMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to send a broadcast message to multiple rooms they are subscribed to. &quot;&quot;&quot;</span>
        <span class="sd">&quot;&quot;&quot;The client can select the rooms to broadcast to then they can enter their message.&quot;&quot;&quot;</span>
        <span class="sd">&quot;&quot;&quot;The request is then sent to the server for verification/handling.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">rooms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="n">rooms</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">strDesiredRooms</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="s2">&quot;Which room numbers would you like to join? Please enter as a space separated list of numbers: &quot;</span><span class="p">)</span>
        <span class="n">indexDesiredRooms</span> <span class="o">=</span> <span class="n">strDesiredRooms</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">numRooms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span>
            <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numRooms</span><span class="p">):</span>
                <span class="n">strindex</span> <span class="o">=</span> <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">strindex</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">desiredRooms</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indexDesiredRooms</span><span class="p">:</span>
                <span class="n">desiredRooms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rooms</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

            <span class="n">message</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the message you wish to broadcast: &quot;</span><span class="p">)</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">desiredRooms</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">broadcastHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_BROADCAST_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">broadcastPayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">desiredRooms</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="n">ircPacket</span><span class="p">(</span><span class="n">broadcastHeader</span><span class="p">,</span> <span class="n">broadcastPayload</span><span class="p">)))</span>
            <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sendServerQuit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The method is for when the client desires to quit the chat program. It sends a request to the server to leave&quot;&quot;&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">CLIENT_QUIT_MSG</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">pkt</span> <span class="o">=</span> <span class="n">ircPacket</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">pkt</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">listUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method lists the current users of the room the client is currently in.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Here are the users in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoomUsers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">user</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Me!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getUsersInCurrentRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method sends a request to the server for a list of users </span>
<span class="sd">            who are in the room that the requesting client currently is in&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;private: &quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">listUsersPayload</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">listUsersPayload</span><span class="p">)</span>
        <span class="n">listUsersHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_MEMBERS_OF_ROOM_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">pkt</span> <span class="o">=</span> <span class="n">ircPacket</span><span class="p">(</span><span class="n">listUsersHeader</span><span class="p">,</span> <span class="n">listUsersPayload</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">pkt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">listCommands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays to the client a list of available actions in the program.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter a message to send to your current room or enter a command.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available commands:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------ to send a message to the current room, just type it and send&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-help&#39;            or &#39;-h&#39;     to see all of these commands again.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-privatemessage&#39;  or &#39;-pm&#39;    to send a private message to another user.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-broadcast&#39;       or &#39;-bm&#39;    to send a broadcast message to several rooms.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-listmessages&#39;    or &#39;-lm&#39;    to see all of the messages in the room you are currently in.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-joinroom&#39;        or &#39;-j&#39;     to join a public chat room.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-listusers&#39;       or &#39;-lu&#39;    to see who else is in the room you are in.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-makeroom&#39;        or &#39;-mkrm&#39;  to make a new chat room. &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-changeroom&#39;      or &#39;-cr&#39;    to change to a room you are joined. &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-listpublicrooms&#39; or &#39;-lpr&#39;   to see all available rooms.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-myrooms&#39;         or &#39;-myrms&#39; to see the rooms you are registered in. &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-leaveroom&#39;       or &#39;-lrm&#39;    to unsubscribe from your current room.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-quit&#39;            or &#39;-q&#39;     to end the program. &quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">handleInput</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method handles user input in the program. &quot;&quot;&quot;</span>
        <span class="n">userDone</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># initial entry in the program lists all commands to the user.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listCommands</span><span class="p">()</span>
        <span class="k">while</span><span class="p">(</span><span class="n">userDone</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>

            <span class="c1"># Upon every iteration, the state of known rooms, all known users, and all users in the</span>
            <span class="c1"># clients current room are updated.</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getUsersInCurrentRoom</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getAllRooms</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getAllUsers</span><span class="p">()</span>

            <span class="n">messageBody</span><span class="o">=</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Message: &quot;</span><span class="p">)</span>
            <span class="n">userMessage</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">messageBody</span><span class="p">)</span>

            <span class="k">if</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-quit&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-q&quot;</span><span class="p">):</span>
                <span class="n">userDone</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendServerQuit</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-listusers&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lu&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listUsers</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-help&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-h&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listCommands</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-makeroom&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-mkrm&quot;</span><span class="p">):</span>  <span class="c1"># -makeroom lydiaroom</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">makeRoom</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-listpublicrooms&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lpr&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listPublicRooms</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-joinroom&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s1">&#39;-j&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">joinRoom</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-myrooms&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-myrms&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listMyRooms</span><span class="p">()</span>

            <span class="c1"># enter a room you are registered to</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-cr&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-changeroom&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">changeRoom</span><span class="p">()</span>

            <span class="c1"># send private message</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-pm&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-privatemessage&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendPrivateMessage</span><span class="p">()</span>

            <span class="c1"># leave room</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-leaveroom&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lrm&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">leaveRoom</span><span class="p">()</span>

            <span class="c1"># send broadcast message</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-broadcast&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-bm&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendBroadcastMessage</span><span class="p">()</span>

            <span class="c1"># list messages</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lm&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-listmessages&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">showCurrentRoomMessages</span><span class="p">()</span>

            <span class="c1"># send message to room</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span><span class="n">messageBody</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">listMyRooms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all of the rooms a user is currently joined to. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Here are the rooms you currently are a part of: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Room Name: </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">You are currently IN room: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">sendMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">userMessage</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method handles the logic of sending a message to a room, or to a particular client in the </span>
<span class="sd">        case of private messaging.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">userMessage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;private: &quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">:</span>  <span class="c1"># private: Tristan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">messageHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_PRIV_MSG_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">msgPayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="n">messageHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_MSG_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">msgPayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">messageHeader</span><span class="p">,</span> <span class="n">msgPayload</span><span class="p">)))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error received: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">showKnownUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all clients connected to the server.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Here is a list of every user who is currently online:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">knownUsers</span><span class="p">:</span>
            <span class="k">if</span><span class="p">(</span><span class="n">user</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Me!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sendPrivateMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to initiate a new private chat with a particular client</span>
<span class="sd">        or allows a client to continue an already existing private chat. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">showKnownUsers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="s2">&quot;Who would you like to private message with?: &quot;</span><span class="p">)</span>

        <span class="c1"># look to see if private chat thread exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;private: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="n">privateMessageRecipient</span> <span class="o">=</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enterPrivateChat</span><span class="p">(</span><span class="n">privateMessageRecipient</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You are now chatting with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showCurrentRoomMessages</span><span class="p">()</span>
        

        <span class="c1"># start new chat thread</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="p">)</span>
            <span class="n">privateMessageHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span>
                <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">START_PRIV_CHAT_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">privateMessagePayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="n">ircPacket</span><span class="p">(</span><span class="n">privateMessageHeader</span><span class="p">,</span> <span class="n">privateMessagePayload</span><span class="p">)))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">quit</span><span class="p">()</span>
            <span class="k">return</span> 

    <span class="k">def</span> <span class="nf">showCurrentRoomMessages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all of the stored messages in the current room the client is in.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Messages in room: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are no messages in this room yet.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">leaveRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to leave a room they currently are joined to.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">==</span> <span class="s2">&quot;Lobby&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, but you cannot leave the Lobby&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LEAVE_ROOM_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">roomPayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
                    <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ircPacket</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">payload</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;Lobby&quot;</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">makeRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to make a new public chat room for other users to join.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="s2">&quot;What would you like your room to be called: &quot;</span><span class="p">)</span>
        <span class="n">payloadLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">makeRoomRequestPacketHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span>
            <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">MAKE_ROOM_REQ</span><span class="p">,</span> <span class="n">payloadLength</span><span class="p">)</span>
        <span class="n">makeRoomRequestPacket</span> <span class="o">=</span> <span class="n">ircPacket</span><span class="p">(</span>
            <span class="n">makeRoomRequestPacketHeader</span><span class="p">,</span> <span class="n">roomPayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">makeRoomRequestPacket</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>
</pre></div>

        </details>

            </section>
                <section id="client">
                                <div class="attr class">
        <a class="headerlink" href="#client">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">client</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">client</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents a client to our IRC service. This class provides all abstractions and</span>
<span class="sd">    state that are needed for a client to interact with the IRC service.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Our constructor for client. It takes a name as a string for its sole argument.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c1"># key - senderName/roomName    value - list messages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># Our constructor for client. It takes a name as a string for its sole argument.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">knownUsers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentRoomUsers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serverPort</span> <span class="o">=</span> <span class="mi">6667</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serverIP</span> <span class="o">=</span> <span class="s2">&quot;192.168.1.6&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span> <span class="o">=</span> <span class="mi">4096</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">initializeConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method attempts to connect with the IRC server. If a connection is made, then the user&#39;s name</span>
<span class="sd">        is sent to the server for verification. If the name is legal, then the user is allowed to connect and </span>
<span class="sd">        use the IRC functionality. If the name is illegal, then the program ends with a message to the user.</span>
<span class="sd">        The user can then attempt to enter a new name and try to connect again. &quot;&quot;&quot;</span>

        <span class="c1"># This sets the option for a keepalive pulse to the server.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_KEEPALIVE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># attempt to establish an initial connection. Throws an error if no connection</span>
        <span class="c1"># can be made</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">serverIP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">serverPort</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

        <span class="c1"># catches server acknowledgement. If there is no ack, then the program ends.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">serverResponse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, we couldn&#39;t establish an initial connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="c1"># Client sends their chosen name to the server for verification.</span>
        <span class="c1"># The opcode indicates that the user is wanting to join the server.</span>
        <span class="n">byteStream</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ircPacket</span><span class="p">(</span><span class="n">ircHeader</span><span class="p">(</span>
            <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">REGISTER_CLIENT_REQ</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

        <span class="c1"># attempt to send the message. Throws an error and ends the program if the message cannot be sent.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">byteStream</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Your initial header didn&#39;t go through.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="c1"># attempt to receive the server&#39;s response message for name verification.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">serverResponse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="n">formattedServerResponse</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">serverResponse</span><span class="p">)</span>

        <span class="c1"># If the name is valid then do initial setup like join the client to the &quot;Lobby&quot; room.</span>
        <span class="c1"># Then start a new thread that handles ONLY receiving server messages. The &quot;main&quot; thread</span>
        <span class="c1"># handles user input and sending messages to the server.</span>
        <span class="k">if</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">REGISTER_CLIENT_RESP</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully joined server</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;Lobby&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="s2">&quot;Lobby&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">start_new_thread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handleIncoming</span><span class="p">,</span> <span class="p">())</span>
            <span class="k">while</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handleInput</span><span class="p">()</span>
            <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_NAME</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry, but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> cannot be used because it is invalid. Please enter a new name.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_NAME_LENGTH</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is too long, please try again with a new name.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_NAME_EXISTS</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry, but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> already exists. Please enter a new name.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;An error has occurred. Our server may be down. Please try again later.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;server down&quot;</span>

    <span class="c1"># def sendPacketToServer(self, packet):</span>

    <span class="k">def</span> <span class="nf">handleIncoming</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method is only used by the secondary, &quot;listening&quot; thread for a client. It receives a byte stream from the server, reconstitutes it into a packet object using the</span>
<span class="sd">        pickle library. Then calls self.receiveMessage to handle how the client interprets the server&#39;s message.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">serverResponse</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">receiveMessage</span><span class="p">(</span><span class="n">serverResponse</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error encountered: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ending program&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">receiveMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serverResponse</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method is only used by the secondary, &quot;listening&quot; thread for the client</span>
<span class="sd">        It takes a packet as its sole argument. This method then checks the packet&#39;s opcode to determine</span>
<span class="sd">        how to handle the packet.&quot;&quot;&quot;</span>

        <span class="c1"># FORWARD_MESSAGE</span>
        <span class="c1"># A message was received from another client who is also subscribed to a room</span>
        <span class="c1"># that this client is also subscribed to. This will update the stored messages for this room.</span>
        <span class="k">if</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">FORWARD_MESSAGE</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">receiverName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># SEND_BROADCAST_RESP</span>
        <span class="c1"># This method updates the sending client&#39;s message dictionary for a broadcast message</span>
        <span class="c1"># for each successful message sent, adding those messages to their corresponding room.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_BROADCAST_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">receiverName</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">room</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;Me: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># START_PRIV_CHAT_RESP</span>
        <span class="c1"># The sending client has recieved a response that they are able to initiate</span>
        <span class="c1"># a private chat with the requested client. This adds a new private chat room for</span>
        <span class="c1"># the sending client.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">START_PRIV_CHAT_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You are now chatting with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># SEND_PRIV_MSG_RESP</span>
        <span class="c1"># The sending client was successfully able to send a private message to another client.</span>
        <span class="c1"># This updates the sender&#39;s private message chat thread with the sent message.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_PRIV_MSG_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="n">privRoomName</span> <span class="o">=</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">privRoomName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;Me: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># LIST_MEMBERS_OF_ROOM_RESP</span>
        <span class="c1"># The sending client was successfully able to request a list of active clients</span>
        <span class="c1"># who are currently in the same room as the requesting client. The list gets</span>
        <span class="c1"># replaced with an updated one with every call to this method.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_MEMBERS_OF_ROOM_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoomUsers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># MAKE_ROOM_RESP</span>
        <span class="c1"># room made successfully and the user is added to that room</span>
        <span class="c1"># a new entry in the message dictionary is added for the new room.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">MAKE_ROOM_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># A client has received a private message. If the private chat thread already exists then the message</span>
        <span class="c1"># is appended to the corresponding entry in the message dictionary. If the chat thread does not exist then</span>
        <span class="c1"># a new entry is created in the message dictionary.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">FORWARD_PRIVATE_MESSAGE</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># A client attempted to create a room that already exists.</span>
        <span class="c1"># The room is not recreated, and the client is told that they can join it.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ROOM_ALREADY_EXISTS</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> already exists, you may choose to join it.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># SEND_MSG_RESP</span>
        <span class="c1"># A client was able to successfully send a message to a room.</span>
        <span class="c1"># The message they sent is automatically appended to that rooms message dictionary entry.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_MSG_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;Me: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># JOIN_ROOM_RESP</span>
        <span class="c1"># Client was able to successfully join their desired room.</span>
        <span class="c1"># a new entry in the message dictionary is made for that room and</span>
        <span class="c1"># the user is told of the success</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">JOIN_ROOM_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server sent back </span><span class="si">{</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">room</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">room</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You have successfully joined </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># too many users in room</span>
        <span class="c1"># client is told that they cannot enter a room since it is full</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_TOO_MANY_USERS</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;You cannot currently join </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> because it is currently full.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please try again later.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># room doesn&#39;t exist</span>
        <span class="c1"># client requested to join a room that doesn&#39;t exist. Error message</span>
        <span class="c1"># is given to client</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ROOM_DOES_NOT_EXIST</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sorry, but the room: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> doesn&#39;t exist. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please make a new room or try to join a different one.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1">#already in room</span>
        <span class="c1"># user tried to join a chat room they are already in.</span>
        <span class="c1"># User is prompted to change into it.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_USER_ALREADY_IN_ROOM</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silly goose! You are already in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Try the &#39;-changeroom&#39; or &#39;-cr&#39; command.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># LIST_USERS_RESP</span>
        <span class="c1"># Client requested all known users which are connected to the server</span>
        <span class="c1"># the list of all known clients is added to requesting client&#39;s state</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_USERS_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knownUsers</span> <span class="o">=</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># LIST_ROOMS_RESP</span>
        <span class="c1"># client requested a list of all chat rooms on the server.</span>
        <span class="c1"># server returns the list of all chat rooms and client updates its state</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_ROOMS_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span> <span class="o">=</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># Client attempted to make a room that has an illegal character in it, or it</span>
        <span class="c1"># begins/ends with a space character.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_NAME</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> is not a valid name. Please try making a new room with a different name.&quot;</span><span class="p">)</span>

        <span class="c1"># Client attempted to make a room using a name that is longer than 32 chars or has a length of 0.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_ROOM_NAME_LENGTH</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> is too long of a name. Please try making a room with a shorter name.&quot;</span><span class="p">)</span>

        <span class="c1"># Client attempted to send a message longer than 140 characters.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_MESSAGE_LENGTH</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Sorry but the message you tried to send is too long. Keep it 140 characters or less.&quot;</span><span class="p">)</span>

        <span class="c1"># generic unexpected error. Not recoverable.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCOde</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">IRC_ERR</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Sorry, an unexpected error has occurred and the program is now exiting.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

            <span class="c1"># Nothing should be able to reach this statement. This is probably</span>
            <span class="c1"># a catastropic error, so exit program.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Sorry, an unexpected error has occurred and the program is now exiting.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getAllRooms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method sends a request to the server asking it for a list of all public rooms that the server is</span>
<span class="sd">        keeping track of.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_ROOMS_REQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getAllUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method sends a request to the server asking it for a list of all connected clients.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_USERS_REQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection. In getAllUsers()&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">listPublicRooms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all public chat rooms. Doesn&#39;t show private chat &quot;rooms&quot;.&quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">joinRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; This method first displays all public chat rooms on the server.</span>
<span class="sd">         The user can then enter a list of numbers corresponding to certain rooms.</span>
<span class="sd">         Then a request is sent to the server asking it to add the user to those rooms.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">listPublicRooms</span><span class="p">()</span>
        <span class="n">strDesiredRooms</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Which room numbers do you wish to join?: &quot;</span><span class="p">)</span>
        <span class="n">indexDesiredRooms</span> <span class="o">=</span> <span class="n">strDesiredRooms</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span>
        <span class="n">desiredRooms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">numRooms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span>
            <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numRooms</span><span class="p">):</span>
                <span class="n">strindex</span> <span class="o">=</span> <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">strindex</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indexDesiredRooms</span><span class="p">:</span>
        
                <span class="n">desiredRooms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
                
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;desired rooms: </span><span class="si">{</span><span class="n">desiredRooms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">joinRoomPayload</span> <span class="o">=</span> <span class="n">roomPayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">desiredRooms</span><span class="p">)</span>
        <span class="n">payloadLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">desiredRooms</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">joinRoomHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span>
            <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">JOIN_ROOM_REQ</span><span class="p">,</span> <span class="n">payloadLength</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">joinRoomHeader</span><span class="p">,</span> <span class="n">joinRoomPayload</span><span class="p">)))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection. In joinARoom()&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">changeRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method lets a user change state into a room that they are currently joined to.</span>
<span class="sd">        It will then print the messages for that room.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;What room would you like to enter?: &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showCurrentRoomMessages</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry that room either doesn&#39;t exist or you have not joined it yet.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">enterPrivateChat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desiredUser</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows the user to change state into a private chat with another client&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">desiredUser</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="n">desiredUser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">sendBroadcastMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to send a broadcast message to multiple rooms they are subscribed to. &quot;&quot;&quot;</span>
        <span class="sd">&quot;&quot;&quot;The client can select the rooms to broadcast to then they can enter their message.&quot;&quot;&quot;</span>
        <span class="sd">&quot;&quot;&quot;The request is then sent to the server for verification/handling.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">rooms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="n">rooms</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">strDesiredRooms</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="s2">&quot;Which room numbers would you like to join? Please enter as a space separated list of numbers: &quot;</span><span class="p">)</span>
        <span class="n">indexDesiredRooms</span> <span class="o">=</span> <span class="n">strDesiredRooms</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">numRooms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span>
            <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numRooms</span><span class="p">):</span>
                <span class="n">strindex</span> <span class="o">=</span> <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">strindex</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">desiredRooms</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indexDesiredRooms</span><span class="p">:</span>
                <span class="n">desiredRooms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rooms</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

            <span class="n">message</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the message you wish to broadcast: &quot;</span><span class="p">)</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">desiredRooms</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">broadcastHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_BROADCAST_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">broadcastPayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">desiredRooms</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="n">ircPacket</span><span class="p">(</span><span class="n">broadcastHeader</span><span class="p">,</span> <span class="n">broadcastPayload</span><span class="p">)))</span>
            <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sendServerQuit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The method is for when the client desires to quit the chat program. It sends a request to the server to leave&quot;&quot;&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">CLIENT_QUIT_MSG</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">pkt</span> <span class="o">=</span> <span class="n">ircPacket</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">pkt</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">listUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method lists the current users of the room the client is currently in.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Here are the users in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoomUsers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">user</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Me!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getUsersInCurrentRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method sends a request to the server for a list of users </span>
<span class="sd">            who are in the room that the requesting client currently is in&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;private: &quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">listUsersPayload</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">listUsersPayload</span><span class="p">)</span>
        <span class="n">listUsersHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_MEMBERS_OF_ROOM_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">pkt</span> <span class="o">=</span> <span class="n">ircPacket</span><span class="p">(</span><span class="n">listUsersHeader</span><span class="p">,</span> <span class="n">listUsersPayload</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">pkt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">listCommands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays to the client a list of available actions in the program.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter a message to send to your current room or enter a command.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available commands:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------ to send a message to the current room, just type it and send&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-help&#39;            or &#39;-h&#39;     to see all of these commands again.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-privatemessage&#39;  or &#39;-pm&#39;    to send a private message to another user.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-broadcast&#39;       or &#39;-bm&#39;    to send a broadcast message to several rooms.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-listmessages&#39;    or &#39;-lm&#39;    to see all of the messages in the room you are currently in.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-joinroom&#39;        or &#39;-j&#39;     to join a public chat room.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-listusers&#39;       or &#39;-lu&#39;    to see who else is in the room you are in.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-makeroom&#39;        or &#39;-mkrm&#39;  to make a new chat room. &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-changeroom&#39;      or &#39;-cr&#39;    to change to a room you are joined. &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-listpublicrooms&#39; or &#39;-lpr&#39;   to see all available rooms.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-myrooms&#39;         or &#39;-myrms&#39; to see the rooms you are registered in. &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-leaveroom&#39;       or &#39;-lrm&#39;    to unsubscribe from your current room.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-quit&#39;            or &#39;-q&#39;     to end the program. &quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">handleInput</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method handles user input in the program. &quot;&quot;&quot;</span>
        <span class="n">userDone</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># initial entry in the program lists all commands to the user.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listCommands</span><span class="p">()</span>
        <span class="k">while</span><span class="p">(</span><span class="n">userDone</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>

            <span class="c1"># Upon every iteration, the state of known rooms, all known users, and all users in the</span>
            <span class="c1"># clients current room are updated.</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getUsersInCurrentRoom</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getAllRooms</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getAllUsers</span><span class="p">()</span>

            <span class="n">messageBody</span><span class="o">=</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Message: &quot;</span><span class="p">)</span>
            <span class="n">userMessage</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">messageBody</span><span class="p">)</span>

            <span class="k">if</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-quit&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-q&quot;</span><span class="p">):</span>
                <span class="n">userDone</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendServerQuit</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-listusers&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lu&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listUsers</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-help&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-h&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listCommands</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-makeroom&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-mkrm&quot;</span><span class="p">):</span>  <span class="c1"># -makeroom lydiaroom</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">makeRoom</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-listpublicrooms&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lpr&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listPublicRooms</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-joinroom&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s1">&#39;-j&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">joinRoom</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-myrooms&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-myrms&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listMyRooms</span><span class="p">()</span>

            <span class="c1"># enter a room you are registered to</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-cr&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-changeroom&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">changeRoom</span><span class="p">()</span>

            <span class="c1"># send private message</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-pm&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-privatemessage&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendPrivateMessage</span><span class="p">()</span>

            <span class="c1"># leave room</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-leaveroom&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lrm&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">leaveRoom</span><span class="p">()</span>

            <span class="c1"># send broadcast message</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-broadcast&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-bm&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendBroadcastMessage</span><span class="p">()</span>

            <span class="c1"># list messages</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lm&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-listmessages&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">showCurrentRoomMessages</span><span class="p">()</span>

            <span class="c1"># send message to room</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span><span class="n">messageBody</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">listMyRooms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all of the rooms a user is currently joined to. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Here are the rooms you currently are a part of: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Room Name: </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">You are currently IN room: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">sendMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">userMessage</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method handles the logic of sending a message to a room, or to a particular client in the </span>
<span class="sd">        case of private messaging.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">userMessage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;private: &quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">:</span>  <span class="c1"># private: Tristan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">messageHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_PRIV_MSG_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">msgPayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="n">messageHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_MSG_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">msgPayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">messageHeader</span><span class="p">,</span> <span class="n">msgPayload</span><span class="p">)))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error received: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">showKnownUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all clients connected to the server.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Here is a list of every user who is currently online:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">knownUsers</span><span class="p">:</span>
            <span class="k">if</span><span class="p">(</span><span class="n">user</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Me!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sendPrivateMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to initiate a new private chat with a particular client</span>
<span class="sd">        or allows a client to continue an already existing private chat. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">showKnownUsers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="s2">&quot;Who would you like to private message with?: &quot;</span><span class="p">)</span>

        <span class="c1"># look to see if private chat thread exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;private: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="n">privateMessageRecipient</span> <span class="o">=</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enterPrivateChat</span><span class="p">(</span><span class="n">privateMessageRecipient</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You are now chatting with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showCurrentRoomMessages</span><span class="p">()</span>
        

        <span class="c1"># start new chat thread</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="p">)</span>
            <span class="n">privateMessageHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span>
                <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">START_PRIV_CHAT_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">privateMessagePayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="n">ircPacket</span><span class="p">(</span><span class="n">privateMessageHeader</span><span class="p">,</span> <span class="n">privateMessagePayload</span><span class="p">)))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">quit</span><span class="p">()</span>
            <span class="k">return</span> 

    <span class="k">def</span> <span class="nf">showCurrentRoomMessages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all of the stored messages in the current room the client is in.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Messages in room: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are no messages in this room yet.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">leaveRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to leave a room they currently are joined to.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">==</span> <span class="s2">&quot;Lobby&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, but you cannot leave the Lobby&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LEAVE_ROOM_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">roomPayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
                    <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ircPacket</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">payload</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;Lobby&quot;</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">makeRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to make a new public chat room for other users to join.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="s2">&quot;What would you like your room to be called: &quot;</span><span class="p">)</span>
        <span class="n">payloadLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">makeRoomRequestPacketHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span>
            <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">MAKE_ROOM_REQ</span><span class="p">,</span> <span class="n">payloadLength</span><span class="p">)</span>
        <span class="n">makeRoomRequestPacket</span> <span class="o">=</span> <span class="n">ircPacket</span><span class="p">(</span>
            <span class="n">makeRoomRequestPacketHeader</span><span class="p">,</span> <span class="n">roomPayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">makeRoomRequestPacket</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This class represents a client to our IRC service. This class provides all abstractions and
state that are needed for a client to interact with the IRC service.</p>
</div>


                            <div id="client.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">client</span><span class="signature">(name)</span>    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Our constructor for client. It takes a name as a string for its sole argument.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c1"># key - senderName/roomName    value - list messages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># Our constructor for client. It takes a name as a string for its sole argument.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">knownUsers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentRoomUsers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serverPort</span> <span class="o">=</span> <span class="mi">6667</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serverIP</span> <span class="o">=</span> <span class="s2">&quot;192.168.1.6&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span> <span class="o">=</span> <span class="mi">4096</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Our constructor for client. It takes a name as a string for its sole argument.</p>
</div>


                            </div>
                            <div id="client.initializeConnection" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.initializeConnection">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">initializeConnection</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">initializeConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method attempts to connect with the IRC server. If a connection is made, then the user&#39;s name</span>
<span class="sd">        is sent to the server for verification. If the name is legal, then the user is allowed to connect and </span>
<span class="sd">        use the IRC functionality. If the name is illegal, then the program ends with a message to the user.</span>
<span class="sd">        The user can then attempt to enter a new name and try to connect again. &quot;&quot;&quot;</span>

        <span class="c1"># This sets the option for a keepalive pulse to the server.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_KEEPALIVE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># attempt to establish an initial connection. Throws an error if no connection</span>
        <span class="c1"># can be made</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">serverIP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">serverPort</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

        <span class="c1"># catches server acknowledgement. If there is no ack, then the program ends.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">serverResponse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, we couldn&#39;t establish an initial connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="c1"># Client sends their chosen name to the server for verification.</span>
        <span class="c1"># The opcode indicates that the user is wanting to join the server.</span>
        <span class="n">byteStream</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ircPacket</span><span class="p">(</span><span class="n">ircHeader</span><span class="p">(</span>
            <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">REGISTER_CLIENT_REQ</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

        <span class="c1"># attempt to send the message. Throws an error and ends the program if the message cannot be sent.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">byteStream</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Your initial header didn&#39;t go through.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="c1"># attempt to receive the server&#39;s response message for name verification.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">serverResponse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="n">formattedServerResponse</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">serverResponse</span><span class="p">)</span>

        <span class="c1"># If the name is valid then do initial setup like join the client to the &quot;Lobby&quot; room.</span>
        <span class="c1"># Then start a new thread that handles ONLY receiving server messages. The &quot;main&quot; thread</span>
        <span class="c1"># handles user input and sending messages to the server.</span>
        <span class="k">if</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">REGISTER_CLIENT_RESP</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully joined server</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;Lobby&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="s2">&quot;Lobby&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">start_new_thread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handleIncoming</span><span class="p">,</span> <span class="p">())</span>
            <span class="k">while</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handleInput</span><span class="p">()</span>
            <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_NAME</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry, but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> cannot be used because it is invalid. Please enter a new name.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_NAME_LENGTH</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is too long, please try again with a new name.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_NAME_EXISTS</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry, but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> already exists. Please enter a new name.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;An error has occurred. Our server may be down. Please try again later.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formattedServerResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;server down&quot;</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method attempts to connect with the IRC server. If a connection is made, then the user's name
is sent to the server for verification. If the name is legal, then the user is allowed to connect and 
use the IRC functionality. If the name is illegal, then the program ends with a message to the user.
The user can then attempt to enter a new name and try to connect again.</p>
</div>


                            </div>
                            <div id="client.handleIncoming" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.handleIncoming">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">handleIncoming</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">handleIncoming</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method is only used by the secondary, &quot;listening&quot; thread for a client. It receives a byte stream from the server, reconstitutes it into a packet object using the</span>
<span class="sd">        pickle library. Then calls self.receiveMessage to handle how the client interprets the server&#39;s message.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">serverResponse</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffSize</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">receiveMessage</span><span class="p">(</span><span class="n">serverResponse</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error encountered: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ending program&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method is only used by the secondary, "listening" thread for a client. It receives a byte stream from the server, reconstitutes it into a packet object using the
pickle library. Then calls self.receiveMessage to handle how the client interprets the server's message.</p>
</div>


                            </div>
                            <div id="client.receiveMessage" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.receiveMessage">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">receiveMessage</span><span class="signature">(self, serverResponse)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">receiveMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serverResponse</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method is only used by the secondary, &quot;listening&quot; thread for the client</span>
<span class="sd">        It takes a packet as its sole argument. This method then checks the packet&#39;s opcode to determine</span>
<span class="sd">        how to handle the packet.&quot;&quot;&quot;</span>

        <span class="c1"># FORWARD_MESSAGE</span>
        <span class="c1"># A message was received from another client who is also subscribed to a room</span>
        <span class="c1"># that this client is also subscribed to. This will update the stored messages for this room.</span>
        <span class="k">if</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">FORWARD_MESSAGE</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">receiverName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># SEND_BROADCAST_RESP</span>
        <span class="c1"># This method updates the sending client&#39;s message dictionary for a broadcast message</span>
        <span class="c1"># for each successful message sent, adding those messages to their corresponding room.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_BROADCAST_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">receiverName</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">room</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;Me: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># START_PRIV_CHAT_RESP</span>
        <span class="c1"># The sending client has recieved a response that they are able to initiate</span>
        <span class="c1"># a private chat with the requested client. This adds a new private chat room for</span>
        <span class="c1"># the sending client.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">START_PRIV_CHAT_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You are now chatting with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># SEND_PRIV_MSG_RESP</span>
        <span class="c1"># The sending client was successfully able to send a private message to another client.</span>
        <span class="c1"># This updates the sender&#39;s private message chat thread with the sent message.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_PRIV_MSG_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="n">privRoomName</span> <span class="o">=</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">privRoomName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;Me: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># LIST_MEMBERS_OF_ROOM_RESP</span>
        <span class="c1"># The sending client was successfully able to request a list of active clients</span>
        <span class="c1"># who are currently in the same room as the requesting client. The list gets</span>
        <span class="c1"># replaced with an updated one with every call to this method.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_MEMBERS_OF_ROOM_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoomUsers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># MAKE_ROOM_RESP</span>
        <span class="c1"># room made successfully and the user is added to that room</span>
        <span class="c1"># a new entry in the message dictionary is added for the new room.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">MAKE_ROOM_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># A client has received a private message. If the private chat thread already exists then the message</span>
        <span class="c1"># is appended to the corresponding entry in the message dictionary. If the chat thread does not exist then</span>
        <span class="c1"># a new entry is created in the message dictionary.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">FORWARD_PRIVATE_MESSAGE</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">senderName</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># A client attempted to create a room that already exists.</span>
        <span class="c1"># The room is not recreated, and the client is told that they can join it.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ROOM_ALREADY_EXISTS</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> already exists, you may choose to join it.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># SEND_MSG_RESP</span>
        <span class="c1"># A client was able to successfully send a message to a room.</span>
        <span class="c1"># The message they sent is automatically appended to that rooms message dictionary entry.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_MSG_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;Me: &quot;</span> <span class="o">+</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">messageBody</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># JOIN_ROOM_RESP</span>
        <span class="c1"># Client was able to successfully join their desired room.</span>
        <span class="c1"># a new entry in the message dictionary is made for that room and</span>
        <span class="c1"># the user is told of the success</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">JOIN_ROOM_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server sent back </span><span class="si">{</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">room</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="n">room</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You have successfully joined </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># too many users in room</span>
        <span class="c1"># client is told that they cannot enter a room since it is full</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_TOO_MANY_USERS</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;You cannot currently join </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> because it is currently full.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please try again later.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># room doesn&#39;t exist</span>
        <span class="c1"># client requested to join a room that doesn&#39;t exist. Error message</span>
        <span class="c1"># is given to client</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ROOM_DOES_NOT_EXIST</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sorry, but the room: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> doesn&#39;t exist. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please make a new room or try to join a different one.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1">#already in room</span>
        <span class="c1"># user tried to join a chat room they are already in.</span>
        <span class="c1"># User is prompted to change into it.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_USER_ALREADY_IN_ROOM</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silly goose! You are already in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Try the &#39;-changeroom&#39; or &#39;-cr&#39; command.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># LIST_USERS_RESP</span>
        <span class="c1"># Client requested all known users which are connected to the server</span>
        <span class="c1"># the list of all known clients is added to requesting client&#39;s state</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_USERS_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knownUsers</span> <span class="o">=</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># LIST_ROOMS_RESP</span>
        <span class="c1"># client requested a list of all chat rooms on the server.</span>
        <span class="c1"># server returns the list of all chat rooms and client updates its state</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_ROOMS_RESP</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span> <span class="o">=</span> <span class="n">serverResponse</span><span class="o">.</span><span class="n">payload</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="c1"># Client attempted to make a room that has an illegal character in it, or it</span>
        <span class="c1"># begins/ends with a space character.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_NAME</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> is not a valid name. Please try making a new room with a different name.&quot;</span><span class="p">)</span>

        <span class="c1"># Client attempted to make a room using a name that is longer than 32 chars or has a length of 0.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_ROOM_NAME_LENGTH</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sorry but </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="si">}</span><span class="s2"> is too long of a name. Please try making a room with a shorter name.&quot;</span><span class="p">)</span>

        <span class="c1"># Client attempted to send a message longer than 140 characters.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCode</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">ERR_ILLEGAL_MESSAGE_LENGTH</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Sorry but the message you tried to send is too long. Keep it 140 characters or less.&quot;</span><span class="p">)</span>

        <span class="c1"># generic unexpected error. Not recoverable.</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">serverResponse</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">opCOde</span> <span class="o">==</span> <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">IRC_ERR</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Sorry, an unexpected error has occurred and the program is now exiting.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>

            <span class="c1"># Nothing should be able to reach this statement. This is probably</span>
            <span class="c1"># a catastropic error, so exit program.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Sorry, an unexpected error has occurred and the program is now exiting.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method is only used by the secondary, "listening" thread for the client
It takes a packet as its sole argument. This method then checks the packet's opcode to determine
how to handle the packet.</p>
</div>


                            </div>
                            <div id="client.getAllRooms" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.getAllRooms">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getAllRooms</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">getAllRooms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method sends a request to the server asking it for a list of all public rooms that the server is</span>
<span class="sd">        keeping track of.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_ROOMS_REQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method sends a request to the server asking it for a list of all public rooms that the server is
keeping track of.</p>
</div>


                            </div>
                            <div id="client.getAllUsers" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.getAllUsers">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getAllUsers</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">getAllUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method sends a request to the server asking it for a list of all connected clients.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_USERS_REQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection. In getAllUsers()&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method sends a request to the server asking it for a list of all connected clients.</p>
</div>


                            </div>
                            <div id="client.listPublicRooms" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.listPublicRooms">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">listPublicRooms</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">listPublicRooms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all public chat rooms. Doesn&#39;t show private chat &quot;rooms&quot;.&quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method displays all public chat rooms. Doesn't show private chat "rooms".</p>
</div>


                            </div>
                            <div id="client.joinRoom" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.joinRoom">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">joinRoom</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">joinRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; This method first displays all public chat rooms on the server.</span>
<span class="sd">         The user can then enter a list of numbers corresponding to certain rooms.</span>
<span class="sd">         Then a request is sent to the server asking it to add the user to those rooms.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">listPublicRooms</span><span class="p">()</span>
        <span class="n">strDesiredRooms</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Which room numbers do you wish to join?: &quot;</span><span class="p">)</span>
        <span class="n">indexDesiredRooms</span> <span class="o">=</span> <span class="n">strDesiredRooms</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span>
        <span class="n">desiredRooms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">numRooms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span>
            <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numRooms</span><span class="p">):</span>
                <span class="n">strindex</span> <span class="o">=</span> <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">strindex</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indexDesiredRooms</span><span class="p">:</span>
        
                <span class="n">desiredRooms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knownRooms</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
                
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;desired rooms: </span><span class="si">{</span><span class="n">desiredRooms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">joinRoomPayload</span> <span class="o">=</span> <span class="n">roomPayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">desiredRooms</span><span class="p">)</span>
        <span class="n">payloadLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">desiredRooms</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">joinRoomHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span>
            <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">JOIN_ROOM_REQ</span><span class="p">,</span> <span class="n">payloadLength</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">joinRoomHeader</span><span class="p">,</span> <span class="n">joinRoomPayload</span><span class="p">)))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection. In joinARoom()&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method first displays all public chat rooms on the server.
The user can then enter a list of numbers corresponding to certain rooms.
Then a request is sent to the server asking it to add the user to those rooms.</p>
</div>


                            </div>
                            <div id="client.changeRoom" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.changeRoom">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">changeRoom</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">changeRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method lets a user change state into a room that they are currently joined to.</span>
<span class="sd">        It will then print the messages for that room.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;What room would you like to enter?: &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showCurrentRoomMessages</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry that room either doesn&#39;t exist or you have not joined it yet.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method lets a user change state into a room that they are currently joined to.
It will then print the messages for that room.</p>
</div>


                            </div>
                            <div id="client.enterPrivateChat" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.enterPrivateChat">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">enterPrivateChat</span><span class="signature">(self, desiredUser)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">enterPrivateChat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desiredUser</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows the user to change state into a private chat with another client&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">desiredUser</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="n">desiredUser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method allows the user to change state into a private chat with another client</p>
</div>


                            </div>
                            <div id="client.sendBroadcastMessage" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.sendBroadcastMessage">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sendBroadcastMessage</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">sendBroadcastMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to send a broadcast message to multiple rooms they are subscribed to. &quot;&quot;&quot;</span>
        <span class="sd">&quot;&quot;&quot;The client can select the rooms to broadcast to then they can enter their message.&quot;&quot;&quot;</span>
        <span class="sd">&quot;&quot;&quot;The request is then sent to the server for verification/handling.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">rooms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="n">rooms</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">strDesiredRooms</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="s2">&quot;Which room numbers would you like to join? Please enter as a space separated list of numbers: &quot;</span><span class="p">)</span>
        <span class="n">indexDesiredRooms</span> <span class="o">=</span> <span class="n">strDesiredRooms</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">numRooms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexDesiredRooms</span><span class="p">)</span>
            <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numRooms</span><span class="p">):</span>
                <span class="n">strindex</span> <span class="o">=</span> <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">indexDesiredRooms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">strindex</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">desiredRooms</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indexDesiredRooms</span><span class="p">:</span>
                <span class="n">desiredRooms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rooms</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

            <span class="n">message</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the message you wish to broadcast: &quot;</span><span class="p">)</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">desiredRooms</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">broadcastHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_BROADCAST_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">broadcastPayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">desiredRooms</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="n">ircPacket</span><span class="p">(</span><span class="n">broadcastHeader</span><span class="p">,</span> <span class="n">broadcastPayload</span><span class="p">)))</span>
            <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method allows a client to send a broadcast message to multiple rooms they are subscribed to.</p>
</div>


                            </div>
                            <div id="client.sendServerQuit" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.sendServerQuit">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sendServerQuit</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">sendServerQuit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The method is for when the client desires to quit the chat program. It sends a request to the server to leave&quot;&quot;&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">CLIENT_QUIT_MSG</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">pkt</span> <span class="o">=</span> <span class="n">ircPacket</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">pkt</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>The method is for when the client desires to quit the chat program. It sends a request to the server to leave</p>
</div>


                            </div>
                            <div id="client.listUsers" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.listUsers">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">listUsers</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">listUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method lists the current users of the room the client is currently in.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Here are the users in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoomUsers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">user</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Me!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method lists the current users of the room the client is currently in.</p>
</div>


                            </div>
                            <div id="client.getUsersInCurrentRoom" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.getUsersInCurrentRoom">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getUsersInCurrentRoom</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">getUsersInCurrentRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method sends a request to the server for a list of users </span>
<span class="sd">            who are in the room that the requesting client currently is in&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;private: &quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">listUsersPayload</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">listUsersPayload</span><span class="p">)</span>
        <span class="n">listUsersHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LIST_MEMBERS_OF_ROOM_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">pkt</span> <span class="o">=</span> <span class="n">ircPacket</span><span class="p">(</span><span class="n">listUsersHeader</span><span class="p">,</span> <span class="n">listUsersPayload</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">pkt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error receivced: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method sends a request to the server for a list of users 
who are in the room that the requesting client currently is in</p>
</div>


                            </div>
                            <div id="client.listCommands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.listCommands">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">listCommands</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">listCommands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays to the client a list of available actions in the program.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter a message to send to your current room or enter a command.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available commands:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------ to send a message to the current room, just type it and send&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-help&#39;            or &#39;-h&#39;     to see all of these commands again.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-privatemessage&#39;  or &#39;-pm&#39;    to send a private message to another user.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-broadcast&#39;       or &#39;-bm&#39;    to send a broadcast message to several rooms.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-listmessages&#39;    or &#39;-lm&#39;    to see all of the messages in the room you are currently in.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-joinroom&#39;        or &#39;-j&#39;     to join a public chat room.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-listusers&#39;       or &#39;-lu&#39;    to see who else is in the room you are in.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-makeroom&#39;        or &#39;-mkrm&#39;  to make a new chat room. &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-changeroom&#39;      or &#39;-cr&#39;    to change to a room you are joined. &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-listpublicrooms&#39; or &#39;-lpr&#39;   to see all available rooms.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-myrooms&#39;         or &#39;-myrms&#39; to see the rooms you are registered in. &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-leaveroom&#39;       or &#39;-lrm&#39;    to unsubscribe from your current room.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;-quit&#39;            or &#39;-q&#39;     to end the program. &quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method displays to the client a list of available actions in the program.</p>
</div>


                            </div>
                            <div id="client.handleInput" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.handleInput">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">handleInput</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">handleInput</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method handles user input in the program. &quot;&quot;&quot;</span>
        <span class="n">userDone</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># initial entry in the program lists all commands to the user.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listCommands</span><span class="p">()</span>
        <span class="k">while</span><span class="p">(</span><span class="n">userDone</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>

            <span class="c1"># Upon every iteration, the state of known rooms, all known users, and all users in the</span>
            <span class="c1"># clients current room are updated.</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getUsersInCurrentRoom</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getAllRooms</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getAllUsers</span><span class="p">()</span>

            <span class="n">messageBody</span><span class="o">=</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Message: &quot;</span><span class="p">)</span>
            <span class="n">userMessage</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">messageBody</span><span class="p">)</span>

            <span class="k">if</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-quit&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-q&quot;</span><span class="p">):</span>
                <span class="n">userDone</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wantToQuit</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendServerQuit</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-listusers&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lu&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listUsers</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-help&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-h&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listCommands</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-makeroom&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-mkrm&quot;</span><span class="p">):</span>  <span class="c1"># -makeroom lydiaroom</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">makeRoom</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-listpublicrooms&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lpr&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listPublicRooms</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-joinroom&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s1">&#39;-j&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">joinRoom</span><span class="p">()</span>

            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-myrooms&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-myrms&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listMyRooms</span><span class="p">()</span>

            <span class="c1"># enter a room you are registered to</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-cr&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-changeroom&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">changeRoom</span><span class="p">()</span>

            <span class="c1"># send private message</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-pm&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-privatemessage&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendPrivateMessage</span><span class="p">()</span>

            <span class="c1"># leave room</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-leaveroom&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lrm&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">leaveRoom</span><span class="p">()</span>

            <span class="c1"># send broadcast message</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-broadcast&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-bm&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendBroadcastMessage</span><span class="p">()</span>

            <span class="c1"># list messages</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-lm&quot;</span> <span class="ow">or</span> <span class="n">userMessage</span> <span class="o">==</span> <span class="s2">&quot;-listmessages&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">showCurrentRoomMessages</span><span class="p">()</span>

            <span class="c1"># send message to room</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span><span class="n">messageBody</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method handles user input in the program.</p>
</div>


                            </div>
                            <div id="client.listMyRooms" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.listMyRooms">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">listMyRooms</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">listMyRooms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all of the rooms a user is currently joined to. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Here are the rooms you currently are a part of: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Room Name: </span><span class="si">{</span><span class="n">room</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">You are currently IN room: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method displays all of the rooms a user is currently joined to.</p>
</div>


                            </div>
                            <div id="client.sendMessage" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.sendMessage">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sendMessage</span><span class="signature">(self, userMessage)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">sendMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">userMessage</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method handles the logic of sending a message to a room, or to a particular client in the </span>
<span class="sd">        case of private messaging.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">userMessage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;private: &quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">:</span>  <span class="c1"># private: Tristan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">messageHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_PRIV_MSG_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">msgPayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="n">messageHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">SEND_MSG_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">msgPayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">ircPacket</span><span class="p">(</span><span class="n">messageHeader</span><span class="p">,</span> <span class="n">msgPayload</span><span class="p">)))</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorry, it seems as though you have lost connection.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error received: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">quit</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method handles the logic of sending a message to a room, or to a particular client in the 
case of private messaging.</p>
</div>


                            </div>
                            <div id="client.showKnownUsers" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.showKnownUsers">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">showKnownUsers</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">showKnownUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all clients connected to the server.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Here is a list of every user who is currently online:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">knownUsers</span><span class="p">:</span>
            <span class="k">if</span><span class="p">(</span><span class="n">user</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Me!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method displays all clients connected to the server.</p>
</div>


                            </div>
                            <div id="client.sendPrivateMessage" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.sendPrivateMessage">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sendPrivateMessage</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">sendPrivateMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to initiate a new private chat with a particular client</span>
<span class="sd">        or allows a client to continue an already existing private chat. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">showKnownUsers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="s2">&quot;Who would you like to private message with?: &quot;</span><span class="p">)</span>

        <span class="c1"># look to see if private chat thread exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;private: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="n">privateMessageRecipient</span> <span class="o">=</span> <span class="s2">&quot;private: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enterPrivateChat</span><span class="p">(</span><span class="n">privateMessageRecipient</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You are now chatting with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showCurrentRoomMessages</span><span class="p">()</span>
        

        <span class="c1"># start new chat thread</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="p">)</span>
            <span class="n">privateMessageHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span>
                <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">START_PRIV_CHAT_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">privateMessagePayload</span> <span class="o">=</span> <span class="n">messagePayload</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredUser</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="n">ircPacket</span><span class="p">(</span><span class="n">privateMessageHeader</span><span class="p">,</span> <span class="n">privateMessagePayload</span><span class="p">)))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">quit</span><span class="p">()</span>
            <span class="k">return</span> 
</pre></div>

        </details>

            <div class="docstring"><p>This method allows a client to initiate a new private chat with a particular client
or allows a client to continue an already existing private chat.</p>
</div>


                            </div>
                            <div id="client.showCurrentRoomMessages" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.showCurrentRoomMessages">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">showCurrentRoomMessages</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">showCurrentRoomMessages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method displays all of the stored messages in the current room the client is in.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Messages in room: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">]):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are no messages in this room yet.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method displays all of the stored messages in the current room the client is in.</p>
</div>


                            </div>
                            <div id="client.leaveRoom" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.leaveRoom">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">leaveRoom</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">leaveRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to leave a room they currently are joined to.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">==</span> <span class="s2">&quot;Lobby&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, but you cannot leave the Lobby&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span><span class="n">ircOpcodes</span><span class="o">.</span><span class="n">LEAVE_ROOM_REQ</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">roomPayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
                    <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ircPacket</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">payload</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messageDictionary</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">currentRoom</span> <span class="o">=</span> <span class="s2">&quot;Lobby&quot;</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method allows a client to leave a room they currently are joined to.</p>
</div>


                            </div>
                            <div id="client.makeRoom" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#client.makeRoom">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">makeRoom</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">makeRoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows a client to make a new public chat room for other users to join.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="s2">&quot;What would you like your room to be called: &quot;</span><span class="p">)</span>
        <span class="n">payloadLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">makeRoomRequestPacketHeader</span> <span class="o">=</span> <span class="n">ircHeader</span><span class="p">(</span>
            <span class="n">ircOpcodes</span><span class="o">.</span><span class="n">MAKE_ROOM_REQ</span><span class="p">,</span> <span class="n">payloadLength</span><span class="p">)</span>
        <span class="n">makeRoomRequestPacket</span> <span class="o">=</span> <span class="n">ircPacket</span><span class="p">(</span>
            <span class="n">makeRoomRequestPacketHeader</span><span class="p">,</span> <span class="n">roomPayload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desiredRoom</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">makeRoomRequestPacket</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, it seems as though you have lost connection.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We are ending the program. Please try reconnecting again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This method allows a client to make a new public chat room for other users to join.</p>
</div>


                            </div>
                </section>
    </main>
</body>
</html>